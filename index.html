<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>FlamencoTL</title>
  <link rel="icon" href="./favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Roboto&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/vis-timeline/standalone/umd/vis-timeline-graph2d.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script>
  // Sistema de pestañas general
    document.addEventListener("DOMContentLoaded", function () {
      const tabButtons = document.querySelectorAll(".tab-button");
      const tabContents = document.querySelectorAll(".tab-content");

      tabButtons.forEach(button => {
        button.addEventListener("click", () => {
          const targetTab = button.getAttribute("data-tab");

          // Desactivar todas las pestañas
          tabButtons.forEach(btn => btn.classList.remove("active"));
          tabContents.forEach(tab => tab.classList.remove("active"));

          // Activar la pestaña y contenido seleccionados
          button.classList.add("active");
          document.getElementById(targetTab).classList.add("active");
        });
      });
    });
  </script>

  <link href="https://unpkg.com/vis-timeline/styles/vis-timeline-graph2d.min.css" rel="stylesheet" />
  <style>

    /* ===== ESTILOS DE PESTAÑAS ===== */



    .tabs {
      display: flex;
      margin-bottom: 10px;
      border-bottom: 2px solid #b89475;
    }

    .tab-button {
      background-color: #f4d6b8;
      border: none;
      border-right: 1px solid #b89475;
      padding: 10px 20px;
      cursor: pointer;
      font-family: 'Merriweather', serif;
      font-weight: bold;
      color: #333;
      transition: background-color 0.3s;
    }

    .tab-button:last-child {
      border-right: none;
    }

    .tab-button:hover {
      background-color: #fbe7cf;
    }

    .tab-button.active {
      background-color: #ffffff;
      border-top: 2px solid #b89475;
      color: #000;
    }

    .tab-content {
      display: none;
      background-color: #fcefe0;
      border: 1px solid #b89475;
      border-top: none;
      padding: 20px;
    }

    .tab-content.active {
      display: block;
    }

    /* === Estilos formulario === */
        form {
      background-color: #fdf3e7;
      padding: 15px;
      border: 1px solid #b89475;
      border-radius: 10px;
      max-width: 500px;
    }

    form label {
      font-weight: bold;
      color: #333;
    }

    form input, form textarea {
      width: 90%;
      font-family: 'Roboto', sans-serif;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #b89475;
      border-radius: 5px;
    }

    form button {
      background-color: #b96989;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    form button:hover {
      background-color: #944d6b;
    }

    .btn {
      background-color: #b96989;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    .btn:hover {
      background-color: #944d6b;
    }

    /* === === */
    body {
    font-family: 'Merriweather', serif;
    background-color: #fcefe0; 
    } 

    #timeline {
      width: 133%;
      border: 0px solid rgba(253, 253, 253, 0);
      margin-top: 10px;
      transform: scale(0.75);
      transform-origin: top left;
    }

    #infoTab {
      max-width: 800px;   /* límite del ancho de la zona de texto */
      margin-left: 40 px;     
      margin-right: auto;
      padding: 20px;      /* deja espacio interior */
      line-height: 1.6;   /* mejora la legibilidad */
      font-size: 1rem;    /* tamaño de texto cómodo */
      text-align: justify;
      background-color: #ffffff;
    }

    #contactTab {
      max-width: 800px;   /* límite del ancho de la zona de texto */
      margin-left: 40 px;     
      margin-right: auto;
      padding: 20px;      /* deja espacio interior */
      line-height: 1.6;   /* mejora la legibilidad */
      font-size: 1rem;    /* tamaño de texto cómodo */
      text-align: justify;
      background-color: #ffffff;
    }

    .vis-label {
      text-align:center !important;
      display:flex;
      font-family: 'Merriweather', serif; /* Cambia a la fuente que quieras */
      font-weight: bold;                   /* Negrita opcional */
      font-size: 20px;                     /* Tamaño del texto */
      align-items: center !important;
      color: #333333;                      /* Color del texto */
    }

    .controls {
      margin-bottom: 10px;
    }
    .controls label {
      margin-right: 15px;
      font-weight: bold;
    }

    /* Estilos de items */
    .cantaor { background-color: #b7dde4;
      font-family:'Merriweather', serif !important;
      font-weight: bold;
      border: 2px solid #4b5b5e;  /* borde azul */
      border-radius: 5px !important;  
    }
    .guitarrista { background-color: #cee2be; 
      font-family:'Merriweather', serif !important;
      font-weight: bold;
      border: 2px solid #444a3f ;  /* borde azul */
      border-radius: 5px !important; }
    .hecho {
      font-family:'Merriweather', serif !important;
      font-style: italic;
      background-color: #ffab92 ; /* fondo semitransparente */
      border: 1px solid #593b33 ;        /* línea vertical */
      height: 24px ;                       /* altura suficiente */
      padding-left: 2px;
      font-size: 15px;
    }


    .share-box {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
      max-width: 300px;   /* ajusta esto a tu gusto */
    }

    .share-box input {
      flex: 1;
      padding: 10px;
      border: 1px solid #b89475;
      border-radius: 8px;
      font-family: 'Roboto', sans-serif;
      background-color: #fdf3e7;
      color: #333;
    }

    /* Colores de épocas */
    .carlos-iii { background-color: #efb4666c!important; }
    .carlos-iv { background-color: #ee89596c !important; }
    .guerra-independencia { background-color: #f4a2616c !important; }
    .fernando-vii { background-color: #e97c616c!important; }
    .epoca-isabelina { background-color: #efb3666c !important; }
    .sexenio { background-color: #ee89596c !important; }
    .restauracion { background-color: #f4a2616c !important; }
    .segunda-republica { background-color: #e97c616c !important; }
    .guerra-civil { background-color: #efb3666c !important; }
    .franquismo { background-color:  #ee89596c!important; }
    .transicion { background-color: #f4a2616c !important; }
    /*.democracia { background-color: #e97c616c !important; }*/
  </style>
</head>
<body>
  <!-- === PESTAÑAS DE NAVEGACIÓN === -->
  <div class="tabs">
    <button class="tab-button active" data-tab="timelineTab">Línea del tiempo</button>
    <button class="tab-button" data-tab="infoTab">Información</button>
    <button class="tab-button" data-tab="contactTab">Contacto</button>
  </div>

  <!-- === CONTENIDO DE CADA PESTAÑA === -->
  <div class="tab-content active" id="timelineTab">
    <h2>El cante a través del tiempo</h2>
    <div class="controls">
      <label>Elige lo que quieres ver: </label>
      <label><input type="checkbox" id="chkCantaores" unchecked> Cantaores</label>
      <label><input type="checkbox" id="chkGuitarristas" unchecked> Guitarristas</label>
      <label><input type="checkbox" id="chkHechos" unchecked> Hechos históricos</label>
    </div>
    <div id="timeline"></div>
  </div>

  <div class="tab-content" id="contactTab">
    <h2>Contacto</h2>

    <!--
    <p>En el siguiente formulario puedes enviarme información sobre cualquier artista que creas que se debería incluir en la línea del tiempo, o simplemente puedes usar la caja de comentarios para enviarme cualquier sugerencia.</p>
  -->
    <form id="cantaorForm"  
          action="https://formspree.io/f/mjkaazyj"
          method="POST">

      <label for="detalle">Comentarios o sugerencias:</label><br>
      <textarea id="detalle" name="detalle" rows="4" cols="50"></textarea><br><br>
<!--
      <label for="nombre">Nombre del artista:</label><br>
      <input type="text" id="nombre" name="nombre"><br><br>

      <label for="region">Lugar de nacimiento:</label><br>
      <input type="text" id="region" name="region"><br><br>

      <label for="inicio">Fecha de nacimiento:</label><br>
      <input type="date" id="inicio" name="inicio"><br><br>

      <label for="fin">Fecha de fallecimiento:</label><br>
      <input type="date" id="fin" name="fin"><br><br>
  -->

      <label for="contacto">Tu nombre o contacto (opcional):</label><br>
      <input type="text" id="contacto" name="contacto"><br><br>

      <button type="submit">Enviar</button>
    </form>


    <h2>Compartir</h2>

    <div class="share-box">
      <input id="shareLink" type="text" readonly value="flamencotl.netlify.app">
      <button class="btn" type="button" onclick="copiarLink()">Copiar enlace</button>
    </div>

    <script>
      function copiarLink() {
        navigator.clipboard.writeText(window.location.href)
          .then(() => alert("Enlace copiado al portapapeles ✅"))
          .catch(() => alert("No se pudo copiar el enlace ❌"));
      }
    </script>


    <p id="mensaje" style="display:none; color: green; font-weight: bold;">¡Gracias por tu aportación!</p>
  </div>

  <div class="tab-content" id="infoTab">

    <h2>Información</h2>
    <p>
      Esta web es un proyecto casero para visualizar en una <b>línea del tiempo</b> el rango de vida de los intérpretes flamencos más importantes. 
      Surgió por mi deseo de situar a cada a uno en su contexto histórico y poder comprobar de un vistazo quién fue contemporáneo a quién.
    </p>
    <h3>Contenido y funciones</h3>
    <p>
      La página permite mostrar u ocultar por separado a cantaores, guitarristas y hechos históricos particulares que considero significativos en la historia del flamenco. 
      <b>Si posas el ratón sobre los hechos históricos, aparece un texto explicativo con más detalle.</b> Mi idea es que esto ocurra también con los artistas, pero llevará su tiempo.
    </p>
    <p>
      En la línea temporal se encuentran marcadas distintas etapas de la historia española.
      Sin ánimo de rigor histórico, las épocas que he delimitado son: reinados de Carlos III y Carlos IV, Guerra de Independencia, reinados de Isabel II y Fernando VII, Sexenio Democrático, Restauración, Segunda República, Guerra Civil, Franquismo y la actual época democrática.
      La idea es tenerlas de referencia para ser conscientes de qué contexto histórico tuvo que vivir cada intérprete.
    </p>
    <h3>A quién se ha incluido</h3>
    <p>
      De momento, el único criterio objetivo que estoy siguiendo es el de incluir a artistas que ya hayan fallecido y cuyos años de nacimiento y muerte sean conocidos. 
      A partir de ahí, intento ser lo más completo posible, yendo más allá de gustos personales, pero la lista puede tener ausencias y sesgos que iré tratando de solventar. Por ejemplo, de momento la lista de guitarristas incluidos es mucho más pobre que la de cantaores. 
    </p>
    <h3>Organización por regiones</h3>
    <p>
      Los intérpretes aparecen clasificados por región de origen. De momento, dicha clasificación la hago aproximadamente en función de la provincia, pero con algunas excepciones para separar lugares con entidad propia, como Jerez. 
      Soy consciente de que esta forma de clasificar no capta bien todos los matices de la geografía flamenca, pero de algún modo tenía que simplicar para empezar.
    </p>

    <h3>Sugerencias</h3>
    <p>
      En el apartado de <b>Contacto</b> puedes mandarme cualquier comentario para ayudarme a mejorar la página, o directamente enviarme información de cualquier cantaor o guitarrista que pienses que debería añadir.
    </p>

  </div>

  <script>
    let timeline, items, epocas, cantaoresItems, guitarristasItems, hechosItems, groups;

    function crearTimeline(cantaoresData, guitarristasData, hechosData) {
      // Obtener todas las regiones
      const regiones = [...new Set([...cantaoresData, ...guitarristasData].map(c => c.region))];

      // Grupos: regiones + grupo para hechos históricos
      groups = new vis.DataSet([
        { id: 9999, content: 'Hechos históricos'},
        ...regiones.map((prov, index) => ({ id: index + 1, content: prov })),
        
      ]);

      // Épocas históricas
      epocas = [
        {id: 996, content: 'Carlos III ', start: '1716-01-20', end: '1788-12-14', type: 'background', className: 'carlos-iii'},
        {id: 997, content: 'Carlos IV ', start: '1788-12-14', end: '1808-05-02', type: 'background', className: 'carlos-iv'},
        {id: 998, content: 'GI', start: '1808-05-02', end: '1814-03-22', type: 'background', className: 'guerra-independencia'},
        {id: 999, content: 'Fernando VII', start: '1814-03-22', end: '1833-09-29', type: 'background', className: 'fernando-vii'},
        {id: 1000, content: 'Isabel II', start: '1833-09-29', end: '1868-09-30', type: 'background', className: 'epoca-isabelina'},
        {id: 1001, content: 'Sexenio democrático', start: '1868-09-30', end: '1874-12-29', type: 'background', className: 'sexenio'},
        {id: 1002, content: 'Restauración', start: '1874-12-29', end: '1931-04-14', type: 'background', className: 'restauracion'},
        {id: 1003, content: 'II Rep.', start: '1931-04-14', end: '1936-07-17', type: 'background', className: 'segunda-republica'},
        {id: 1004, content: 'GC', start: '1936-07-17', end: '1939-04-01', type: 'background', className: 'guerra-civil'},
        {id: 1005, content: 'Franquismo', start: '1939-04-01', end: '1978-12-06', type: 'background', className: 'franquismo'},
        {id: 1006, content: 'Democracia', start: '1978-12-06', end: '2026-01-31', type: 'background', className: 'transicion'},
        /*{id: 1007, content: 'Democracia', start: '1978-12-06', end: '2025-09-21', type: 'background', className: 'democracia'},*/
      ];

      cantaoresItems = cantaoresData.map((c, index) => ({
        id: 'c' + (index + 1),   // ID generado automáticamente
        content: c.nombre,
        start: c.start,
        end: c.end,
        title: c.detalle,
        group: regiones.indexOf(c.region) + 1,
        className: 'cantaor'
      }));

      guitarristasItems = guitarristasData.map((g, index) => ({
        id: 'g' + (index + 1),
        content: g.nombre,
        start: g.start,
        end: g.end,
        title: g.detalle,
        group: regiones.indexOf(g.region) + 1,
        className: 'guitarrista'
      }));

      hechosItems = hechosData.map((h, index) => ({
        id: 'h' + (index + 1),
        content: h.hecho,
        start: h.fecha,
        title: h.detalle,
        type: 'box',
        group: 9999,
        className: 'hecho',
        align: 'center'
      }));


      // Combinar todos los items
      items = new vis.DataSet([...epocas, ...cantaoresItems, ...guitarristasItems, ...hechosItems]);

      const options = {
        start: '1749-01-01',
        end: '2030-01-01',
        min: '1716-01-20',
        max: '2030-10-11',
        stack: true,
        showCurrentTime: false,
        orientation: 'top',
        zoomable: false,
        horizontalScroll: true,
        verticalScroll: true,
        maxHeight:900,
        width:'100%',
        autoResize:true,
        orientation: {
          axis: 'both',  // <- esto muestra la escala arriba y abajo
          item: 'bottom' // los items siguen en la parte inferior
        },
      };

      timeline = new vis.Timeline(document.getElementById('timeline'), items, groups, options);

      // Checkboxes para mostrar/ocultar items
      document.getElementById('chkCantaores').addEventListener('change', actualizarItems);
      document.getElementById('chkGuitarristas').addEventListener('change', actualizarItems);
      document.getElementById('chkHechos').addEventListener('change', actualizarItems);
    }

    function actualizarItems() {
      items.clear();
      items.add(epocas);
      if (document.getElementById('chkCantaores').checked) items.add(cantaoresItems);
      if (document.getElementById('chkGuitarristas').checked) items.add(guitarristasItems);
      if (document.getElementById('chkHechos').checked) items.add(hechosItems);
    }

    // Cargar CSVs
    Papa.parse('cantaores.csv', {
      download: true,
      header: true,
      complete: function(cantaores) {
        Papa.parse('guitarristas.csv', {
          download: true,
          header: true,
          complete: function(guitarristas) {
            Papa.parse('hechos.csv', {
              download: true,
              header: true,
              complete: function(hechos) {
                crearTimeline(cantaores.data, guitarristas.data, hechos.data);
                actualizarItems()
              }
            });
          }
        });
      }
    });
  </script>
</body>
</html>
